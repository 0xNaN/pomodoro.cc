#!/bin/bash

set -e

echo "--> installing global dependencies"
npm install

echo "--> installing app dependencies"
(cd app; npm install)

echo "--> installing app_v2 dependencies"
(cd app_v2; npm install)

echo "--> installing api dependencies"
(cd api; npm install)

echo "--> building app"
(cd app; npm run build)

echo "--> building app_v2"
(cd app_v2; npm run build)

echo "--> creating credentials.json"
cp credentials.template.json credentials.json

echo "--> creating opt/docker.env"
cp opt/docker.template.env opt/docker.env

echo "--> setting up self-signed certificate"
unzip ssl.zip -d . || true
